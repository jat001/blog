---
title: WIN8系统的远程桌面漏洞 利用QQ拼音纯净版实现提权
tags:
  - 系统安全
id: 132
categories:
  - 信息安全
date: 2012-12-18 13:36:30
---

<span style="font-size: 13px; font-weight: normal; line-height: 1.5;">发现这个漏洞的时候，</span><span style="font-size: 13px; font-weight: normal; line-height: 1.5;"> 笔者正在机房上课。正想用3389远程桌面去控制宿舍电脑的时候，因为重做系统忘记自己的IP地址，因此就随手扫描了一下IP段开3389端口的电脑。</span>

<span style="font-size: 13px; font-weight: normal; line-height: 1.5;">没想到就随手扫描到一台WIN8的系统，而且这个系统还装了QQ输入法WIN8纯净版。</span>

<span style="font-size: 13px; font-weight: normal; line-height: 1.5;">当时我就想起初中时候的那个极品五笔的漏洞，就随手测试了一下，没想到在时隔7、8年后的今天，号称非常安全的WIN8系统居然还有如此大的漏洞。这边就把提权过程理一遍。</span>

首先确认装有这个QQ拼音输入法

<div style="text-align: center;">[![](//www.sinosky.org/uploads/2012/pic002.cnblogs.com_images_2012_370709_2012112012465611.jpg)](//www.sinosky.org/uploads/2012/pic002.cnblogs.com_images_2012_370709_2012112012465611.jpg)</div>

ctrl+空格调出托盘，找到这个选项

[![](//www.sinosky.org/uploads/2012/pic002.cnblogs.com_images_2012_370709_2012112012470943.jpg)](//www.sinosky.org/uploads/2012/pic002.cnblogs.com_images_2012_370709_2012112012470943.jpg)

顺利开启IE浏览器

[![](//www.sinosky.org/uploads/2012/pic002.cnblogs.com_images_2012_370709_2012112012540075.jpg)](//www.sinosky.org/uploads/2012/pic002.cnblogs.com_images_2012_370709_2012112012540075.jpg)

<div style="text-align: left; font-family: 微软雅黑; font-size: 13px;">这边需要说明的事，IE浏览器和WIN8安全性确实是提高了非常多。

随手在地址栏输入D:\ file://d: 这样的命令都无法打开文件夹

本以为只要随便上传一个bat批处理，写上提权用的命令，然后利用IE下载下来打开运行即可，

没想到各种提示系统要求验证您的用户密码等，根本无法进行下载，可见常规方式真的行不通

微软还是有在修复这些漏洞，但是经过笔者的诸多尝试，最终发现有一处漏洞尚未填补</div>

那就是文件菜单的-另存为选项，将网页文件另存为即可打开文件夹对话框

[![](//www.sinosky.org/uploads/2012/pic002.cnblogs.com_images_2012_370709_2012112013010977.jpg)](//www.sinosky.org/uploads/2012/pic002.cnblogs.com_images_2012_370709_2012112013010977.jpg)

这个时候感觉已经快要接近胜利，但是经过半节课多的尝试，笔者始终无法再有实质性的突破

如图，文件夹选项卡已经被限定成几种mnt、txt等格式

[![](//www.sinosky.org/uploads/2012/pic002.cnblogs.com_images_2012_370709_2012112013030432.jpg)](//www.sinosky.org/uploads/2012/pic002.cnblogs.com_images_2012_370709_2012112013030432.jpg)

<div style="text-align: left; font-family: 微软雅黑; font-size: 13px;">笔者甚至能用记事本等程序打开进行提权命令编辑，但是关键的地方却始终被微软限制

不管是另存为bat或者打开其他程序，均无法显示或者正常打开。

而且就算保存成bat，在当前限定的mnt、txt等文件可查看的情况下根本也无法看到生成后的文件</div>

[![](//www.sinosky.org/uploads/2012/pic002.cnblogs.com_images_2012_370709_2012112013041180.jpg)](//www.sinosky.org/uploads/2012/pic002.cnblogs.com_images_2012_370709_2012112013041180.jpg)

<div style="text-align: left; font-family: 微软雅黑; font-size: 13px;">在进行了诸多尝试，甚至开启文件夹共享，也无法生效

可见WIN8还是对安全性进行了很大的提升</div>
<div style="text-align: left; font-family: 微软雅黑; font-size: 13px;">这个时候，笔者想起初中时奋斗的那些日日夜夜，想到了解决办法

没错，就是用快捷方式的漏洞

在无法查看任何exe等可执行文件的情况下，包括net.exe 这个关键的提权程序时，实际上也可以直接创建快捷方式

对这个快捷方式直接赋参数运行。随便创建一个快捷方式，然后将目标改为系统目录里面的net文件 后面空格附上参数即可</div>

创建用户Helper

[![](//www.sinosky.org/uploads/2012/pic002.cnblogs.com_images_2012_370709_2012112013091651.jpg)](//www.sinosky.org/uploads/2012/pic002.cnblogs.com_images_2012_370709_2012112013091651.jpg)

将用户加入管理组，获取最高权限

[![](//www.sinosky.org/uploads/2012/pic002.cnblogs.com_images_2012_370709_2012112013121284.jpg)](//www.sinosky.org/uploads/2012/pic002.cnblogs.com_images_2012_370709_2012112013121284.jpg)

好了激动人心的时刻到了

[![](//www.sinosky.org/uploads/2012/pic002.cnblogs.com_images_2012_370709_2012112013131278.jpg)](//www.sinosky.org/uploads/2012/pic002.cnblogs.com_images_2012_370709_2012112013131278.jpg)

OK，登陆成功,用了一节课时间就可以了。

[![](//www.sinosky.org/uploads/2012/pic002.cnblogs.com_images_2012_370709_2012112013132698.jpg)](//www.sinosky.org/uploads/2012/pic002.cnblogs.com_images_2012_370709_2012112013132698.jpg)

本次只测试过QQ拼音输入法，其他输入法如果能直接调出IE的话，利用相同的办法也可以直接提权，希望微软尽快修复这个漏洞吧。

Posted on [http://www.cnblogs.com/maybreath/archive/2012/11/20/2778875.html](http://www.cnblogs.com/maybreath/archive/2012/11/20/2778875.html)