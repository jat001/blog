---
title: 服务质量 (QoS)：下载、游戏两不误
id: 991
categories:
  - 未分类
tags:
---

QoS 全称是 Quality of Service，普遍译为术语“服务质量”，是一个不怎么被人提起却有重要作用的流量交换控制功能。

在 QoS 诞生之前，互联网流量交换是“全单工”的，后发起传输请求的程序始终无法获得高于先发起传输请求程序的优先级；且负责数据交换的设备对所有流量一视同仁，时常会导致“重量级客户”得不到应有的重视。举个简单例子，我们时常遇到“互抢网速”的问题：宿舍使用一个路由器分 10M 带宽给三个住户，一个在看在线非黄色小说，一个在玩流行网游，一个在全速下载不知道什么东西。在没有设置 QoS 时，路由器只会根据流量的先后顺序转发数据包，于是看小说的刷不出新章节；玩网游的技能发不出去，还要忍受五分钟重连一次的悲剧；似乎只有下载者最开心，除了一点点速度波动几乎感觉不到不愉快……在这个例子中，看小说需要的流量最少，且不需要保持任何“实时连接”，但希望以最快的速度完成数据收发；玩网游需要的流量也并不多，重在要求保证连接的稳定和效率；而下载是流量大户，虽然对速度也有要求，不过并不如网游那么苛刻。于是通过在路由器上进行 QoS 设置，针对不同端口、客户端实行优先级分配和实时流量限制，就能达到双赢的效果。

_QoS 设置在不同路由器上有所不同，这里以网件 (Netgear) 路由器内置的 NetGenie 管理界面为例。_

想要分配端口和客户端优先级，首先肯定要制定端口和客户端，几乎所有软件/协议的端口都可以在 [IANA 服务和协议端口注册列表](http://www.iana.org/assignments/service-names-port-numbers/service-names-port-numbers.xhtml) 中找到，例如所有暴雪 (Blizzard Entertainment) 出品的游戏都使用 TCP/UDP 1119 端口连接游戏和聊天服务器，而 1120 端口则单独用于更新文件下载；需要注意的是有很多知名的服务端口并不仅仅适用于某个程序，比如几乎所有涉及网络连接的软件都会使用到 TCP/UDP 80 端口传输非加密内容（加密内容则通过 443 端口传输），如果将这些通用端口的优先级调整过高，QoS 则名存实亡。